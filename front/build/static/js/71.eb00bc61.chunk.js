"use strict";(self.webpackChunkweb_scada=self.webpackChunkweb_scada||[]).push([[71],{98629:function(t,e,a){var r=a(1413),n=a(29439),i=a(72791),o=a(13967),s=a(13496),d=a(91933),c=a(95791),l=a(72426),u=a.n(l),f=a(80184),h={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}};e.Z=function(t){var e=t.queryData,a=t.name,l=(0,o.Z)(),x=l.palette.text.secondary,m=l.palette.divider,p=(0,i.useState)(h),Z=(0,n.Z)(p,2),g=Z[0],v=Z[1],j=(0,i.useState)([]),S=(0,n.Z)(j,2),b=S[0],y=S[1],w=(0,d.useQuery)(["chartData",e],(function(){return c.Z.getArchive(e)}),{select:function(t){return t.archive},refetchOnWindowFocus:!1,onSuccess:function(t){var e=null===t||void 0===t?void 0:t.map((function(t){return[t.date,t.dec]}));console.log(t,e),y([{name:a,data:e}])},enabled:!!e}).isLoading;return(0,i.useEffect)((function(){v((function(t){return(0,r.Z)((0,r.Z)({},t),{},{chart:{id:"area-datetime",type:"area",width:"100%",zoom:{autoScaleYaxis:!0},events:{}},colors:[l.palette.primary.main],xaxis:{type:"datetime",tickAmount:4,tickPlacement:"between",labels:{style:{colors:[x]},rotateAlways:!1,formatter:function(t){return"".concat(u()(t).format("DD.MM.YYYY")," ").concat(u()(t).format("HH:mm:ss"))}},axisBorder:{show:!0,color:m}},yaxis:{labels:{style:{colors:[x]}}},grid:{borderColor:m,padding:{top:0,right:0,bottom:0,left:15}},tooltip:{theme:"light"},noData:{text:w?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u043e\u0442\u0440\u0435\u0437\u043e\u043a"}})}))}),[]),(0,f.jsx)(s.Z,{options:g,series:b,type:"area",height:450})}},72205:function(t,e,a){a.d(e,{Z:function(){return M}});var r=a(1413),n=a(29439),i=a(72791),o=a(90444),s=a(72426),d=a.n(s),c=a(86812),l=a(80395),u=a(81153),f=a(36314),h=a(5849),x=a(91933),m=a(95791);var p=a(71652),Z=a(84876),g=a(24750),v=(a(67448),a(47024)),j=a(80184),S=function(t){return d()(t).format("HH:mm:ss DD.MM.YYYY")},b={dateStart:null,dateStop:null},y=function(t){var e=t.id,a=(0,i.useState)(b),s=(0,n.Z)(a,2),d=s[0],y=s[1],w=(0,i.useState)({id:e}),k=(0,n.Z)(w,2),M=k[0],A=k[1],D=function(t,e){e.setSelectedKeys("true"),y(t)},C=(0,x.useQuery)(["archiveError1",M],(function(){return m.Z.getArchiveAlarm(M)}),{select:function(t){return function(t){var e=Object.assign([],t);e.reverse();for(var a=[],n=0;n<e.length;n++)if(e[n].status)for(var i=0+n;i<e.length;i++){if(!e[i].status&&e[n].bit===e[i].bit){a.push((0,r.Z)((0,r.Z)({},e[n]),{},{date2:e[i].date}));break}i===e.length-1&&(a.push((0,r.Z)((0,r.Z)({},e[n]),{},{date2:null})),console.log(!0))}return a.reverse()}(t.errorArchive)},refetchOnWindowFocus:!1,enabled:!!M.id}),P=C.data,L=C.isLoading,Y=(0,i.useMemo)((function(){return null===P||void 0===P?void 0:P.map((function(t){return(0,r.Z)((0,r.Z)({},t),{},{dateFormat:S(t.date),date2Format:t.date2?S(t.date2):"-",timeStop:t.date2&&t.date2-t.date,timeStopFormat:t.date2?(0,l._F)((t.date2-t.date)/1e3):"-"})}))}),[P]),F=[{title:"\u0414\u0430\u0442\u0430",dataIndex:"dateFormat",key:"date",width:150,align:"center",sorter:function(t,e){return t.date-e.date},filters:[{dateStart:"",dateStop:""}],filterDropdown:function(t){return(0,j.jsxs)(u.ZP,{children:[(0,j.jsx)(f.Z,{spacing:1.5,sx:{p:1},children:(0,j.jsxs)(p._,{dateAdapter:g.y,adapterLocale:"ru",localeText:v.n.components.MuiLocalizationProvider.defaultProps.localeText,children:[(0,j.jsx)(Z.x,{value:d.dateStart,autoFocus:!0,sx:{mt:1},label:"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u0430\u0442\u0430",onChange:function(e){return D((0,r.Z)((0,r.Z)({},d),{},{dateStart:e.$d.valueOf()}),t)}}),(0,j.jsx)(Z.x,{value:d.dateStop,sx:{mt:1},label:"\u041a\u043e\u043d\u0435\u0447\u043d\u0430\u044f \u0434\u0430\u0442\u0430",onChange:function(e){return D((0,r.Z)((0,r.Z)({},d),{},{dateStop:e.$d.valueOf()}),t)}})]})}),(0,j.jsxs)(u.ZP,{container:!0,justifyContent:"space-between",sx:{p:1},children:[(0,j.jsx)(h.Z,{type:"submit",color:"primary",onClick:function(){return function(t){t.clearFilters(),y(b)}(t)},size:"small",disabled:0===t.selectedKeys.length,children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"}),(0,j.jsx)(h.Z,{type:"submit",variant:"contained",color:"primary",onClick:function(){return function(t){t.confirm();var a={};null!==d.dateStart&&(a.dateStart=d.dateStart),null!==d.dateStop&&(a.period=d.dateStop-d.dateStart),A((0,r.Z)({id:e},a))}(t)},size:"small",children:"\u041e\u041a"})]})]})}},{title:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",dataIndex:"message",key:"message",width:300,filters:[{text:"\u0417\u0430\u043a\u043b\u0435\u0439\u0449\u0438\u043a. \u0420\u0430\u0441\u0445\u043e\u0434\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b \u043d\u0430 \u0438\u0441\u0445\u043e\u0434\u0435",value:"\u0417\u0430\u043a\u043b\u0435\u0439\u0449\u0438\u043a. \u0420\u0430\u0441\u0445\u043e\u0434\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b \u043d\u0430 \u0438\u0441\u0445\u043e\u0434\u0435"},{text:"\u0423\u043a\u043b\u0430\u0434\u043a\u0430. \u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u043e\u043f\u0440\u0438\u0432\u043e\u0434\u0430",value:"\u0423\u043a\u043b\u0430\u0434\u043a\u0430. \u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u043e\u043f\u0440\u0438\u0432\u043e\u0434\u0430"}],onFilter:function(t,e){return e.message.includes(t)}},{title:"\u0414\u0430\u0442\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f",dataIndex:"date2Format",key:"date2",width:150,align:"center",sorter:function(t,e){return t.date2-e.date2}},{title:"\u0412\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u044f",dataIndex:"timeStopFormat",key:"timeStop",width:150,align:"center",sorter:function(t,e){return t.timeStop-e.timeStop}}];return(0,j.jsx)(o.Z,{locale:c.Z.Table,columns:F,dataSource:Y,size:"medium",pagination:!1,scroll:{y:450,x:600},tableLayout:"auto",loading:L})},w=a(4567),k=a(5896),M=function(t){var e=t.id;return(0,j.jsxs)(u.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,j.jsx)(u.ZP,{item:!0,children:(0,j.jsx)(w.Z,{variant:"h4",children:"\u0410\u0432\u0430\u0440\u0438\u0439\u043d\u044b\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})}),(0,j.jsx)(k.Z,{content:!1,sx:{mt:2},children:(0,j.jsx)(y,{id:e})})]})}},4071:function(t,e,a){a.r(e),a.d(e,{default:function(){return _}});var r=a(1413),n=a(29439),i=a(13967),o=a(81153),s=a(4567),d=a(90977),c=a(52744),l=a(36314),u=a(93006),f=a(5849),h=a(43236),x=a(52411),m=a(49900),p=a(54333),Z=a(60220),g=a(5896),v=a(72791),j=a(80609),S=a(82033),b=a(67575),y=a(14541),w=(a(98629),(0,a(50225).default)(a(37328).Switch)((function(t){var e=t.theme;return{width:70,height:32,padding:0,display:"flex","&:active":{"& .MuiSwitch-thumb":{width:37.5},"& .MuiSwitch-switchBase.Mui-checked":{transform:"translateX(25px)"}},"& .MuiSwitch-switchBase":{padding:4,"&.Mui-checked":{transform:"translateX(38px)",color:"#fff","& + .MuiSwitch-track":{opacity:1,backgroundColor:"dark"===e.palette.mode?"#177ddc":"#1890ff"}}},"& .MuiSwitch-thumb":{boxShadow:"0 2px 4px 0 rgb(0 35 11 / 20%)",width:24,height:24,borderRadius:12,transition:e.transitions.create(["width"],{duration:200})},"& .MuiSwitch-track":{borderRadius:16,opacity:1,backgroundColor:"dark"===e.palette.mode?"rgba(255,255,255,.35)":"rgba(0,0,0,.25)",boxSizing:"border-box"}}}))),k=a(72205),M=a(94895),A=a(95791),D=a(72426),C=a.n(D),P=a(91933),L=a(82030),Y=a(21947),F=a(82839),O=a(90466),z=a(12891),I=a(35667),R=a(18602),H=a(78893),B=a(80184),K={data:[],left:"dataMin",right:"dataMax",refAreaLeft:"",refAreaRight:"",top:"dataMax+30",bottom:"dataMin-30",animation:!0},T=function(t){var e=t.queryData,a=t.name,s=(0,v.useState)(K),c=(0,n.Z)(s,2),l=c[0],u=c[1],f=(0,i.Z)().palette,h=((0,P.useQuery)(["chartData",e],(function(){return A.Z.getArchive(e)}),{select:function(t){return t.archive},refetchOnWindowFocus:!1,onSuccess:function(t){var e=null===t||void 0===t?void 0:t.map((function(t){return{date:Number(t.date),dec:Number(t.dec)}}));console.log(t,e),u((0,r.Z)((0,r.Z)({},l),{},{data:e,left:"dataMin",right:"dataMax"}))},enabled:!!e}).isLoading,function(){u((0,r.Z)((0,r.Z)({},l),{},{refAreaLeft:"",refAreaRight:"",left:"dataMin",right:"dataMax",top:"dataMax+30",bottom:"dataMin-30"}))});return(0,B.jsxs)(o.ZP,{container:!0,sx:{userSelect:"none",p:1},justifyContent:"right",children:[(0,B.jsx)(d.Z,{onClick:h,children:(0,B.jsx)(M.Z,{})}),(0,B.jsx)(d.Z,{onClick:h,children:(0,B.jsx)(M.Z,{})}),(0,B.jsx)(L.h,{width:"100%",minHeight:400,children:(0,B.jsxs)(Y.T,{data:l.data,onMouseDown:function(t){return u((0,r.Z)((0,r.Z)({},l),{},{refAreaLeft:null===t||void 0===t?void 0:t.activeLabel}))},onMouseMove:function(t){return l.refAreaLeft&&u((0,r.Z)((0,r.Z)({},l),{},{refAreaRight:null===t||void 0===t?void 0:t.activeLabel}))},onMouseUp:function(){var t=l.refAreaLeft,e=l.refAreaRight;if(t!==e&&""!==e){if(t>e){var a=[e,t];t=a[0],e=a[1]}u((0,r.Z)((0,r.Z)({},l),{},{refAreaLeft:"",refAreaRight:"",left:t,right:e}))}else u((0,r.Z)((0,r.Z)({},l),{},{refAreaLeft:"",refAreaRight:""}))},children:[(0,B.jsx)("defs",{children:(0,B.jsxs)("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,B.jsx)("stop",{offset:"5%",stopColor:f.primary.main,stopOpacity:.6}),(0,B.jsx)("stop",{offset:"100%",stopColor:f.primary.main,stopOpacity:.1})]})}),(0,B.jsx)(F.q,{strokeDasharray:"2 5",vertical:!1}),(0,B.jsx)(O.K,{allowDataOverflow:!0,dataKey:"date",domain:[l.left,l.right],type:"number",tickSize:10,axisLine:{backgroundColor:"red"},tickCount:7,interval:"preserveStartEnd",tick:{fontSize:"0.75rem"},tickFormatter:function(t){return"".concat(C()(t).format("DD.MM.YYYY")," ").concat(C()(t).format("HH:mm:ss"))}}),(0,B.jsx)(z.B,{name:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",allowDataOverflow:!0,domain:[l.bottom,l.top],type:"number",yAxisId:"1",axisLine:!1,tickLine:!1,tick:{fontSize:"0.75rem"}}),(0,B.jsx)(I.u,{name:"\u0414\u0430\u0442\u0430",formatter:function(t){return[t,a]},labelFormatter:function(t){return"".concat(C()(t).format("DD.MM.YYYY")," ").concat(C()(t).format("HH:mm:ss"))}}),(0,B.jsx)(R.u,{yAxisId:"1",dataKey:"dec",stroke:f.primary.main,strokeWidth:2,fill:"url(#colorPv)",animationDuration:300,fillOpacity:.6}),l.refAreaLeft&&l.refAreaRight?(0,B.jsx)(H.z,{yAxisId:"1",x1:l.refAreaLeft,x2:l.refAreaRight,strokeOpacity:.1,stroke:f.primary.main}):null]})})]})},_=function(){var t=(0,v.useState)(null),e=(0,n.Z)(t,2),a=e[0],M=e[1],A=(0,v.useState)(null),D=(0,n.Z)(A,2),C=D[0],P=D[1],L=Boolean(a),Y=(0,i.Z)(),F=(0,v.useState)({dateStart:Date.now()-36e7,dateStop:Date.now()}),O=(0,n.Z)(F,2),z=O[0],I=O[1],R=(0,v.useState)({dateStart:Date.now()-36e7,period:36e5,id:"647ead32652edbe984336ec6"}),H=(0,n.Z)(R,2),K=H[0],_=H[1];return(0,B.jsxs)(o.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,B.jsx)(o.ZP,{item:!0,xs:12,sx:{mb:-2.25},children:(0,B.jsx)(s.Z,{variant:"h5",children:"C \u0414\u043d\u0435\u043c \u0420\u043e\u0436\u0434\u0435\u043d\u0438\u044f!"})}),(0,B.jsx)(o.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,B.jsx)(g.Z,{content:!1,children:(0,B.jsxs)(o.ZP,{container:!0,justifyContent:"right",children:[(0,B.jsx)(d.Z,{"aria-label":"more",id:"long-button","aria-controls":L?"long-menu":void 0,"aria-expanded":L?"true":void 0,"aria-haspopup":"true",onClick:function(t){M(t.currentTarget)},size:"medium",children:L?(0,B.jsx)(j.Z,{}):(0,B.jsx)(S.Z,{})}),(0,B.jsx)(c.Z,{id:"long-menu",anchorEl:a,open:L,onClose:function(){M(null)},PaperProps:{style:{padding:10}},children:(0,B.jsxs)(l.Z,{spacing:1,children:[(0,B.jsx)(u.Z,{id:"datetime-local",placeholder:"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u0430\u0442\u0430",type:"datetime-local",sx:{width:200},InputLabelProps:{shrink:!0},value:z.dateStart,onChange:function(t){return I((0,r.Z)((0,r.Z)({},z),{},{dateStart:t.target.value}))}}),(0,B.jsx)(u.Z,{id:"datetime-local",placeholder:"\u041a\u043e\u043d\u0435\u0447\u043d\u0430\u044f \u0434\u0430\u0442\u0430",type:"datetime-local",sx:{width:200},InputLabelProps:{shrink:!0},value:z.dateStop,onChange:function(t){return I((0,r.Z)((0,r.Z)({},z),{},{dateStop:t.target.value}))}}),(0,B.jsx)(f.Z,{type:"submit",variant:"outlined",color:"primary",onClick:function(t){t.preventDefault(),_((0,r.Z)((0,r.Z)({},K),{},{dateStart:new Date(z.dateStart).valueOf(),period:new Date(z.dateStop).valueOf()-new Date(z.dateStart).valueOf()}))},children:"\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c"})]})})]})})}),(0,B.jsx)(o.ZP,{item:!0,xs:12,md:12,lg:4,children:(0,B.jsx)(g.Z,{content:!1,children:(0,B.jsxs)(h.Z,{component:"nav",sx:{px:0,py:0},children:[(0,B.jsxs)(x.ZP,{sx:{height:80},divider:!0,children:[(0,B.jsx)(m.Z,{primary:(0,B.jsx)(s.Z,{variant:"subtitle1",children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u043e\u043f\u0440\u0438\u0432\u043e\u0434"})}),(0,B.jsx)(p.Z,{children:(0,B.jsx)(w,{onClick:function(){P(!C)}})})]}),(0,B.jsxs)(x.ZP,{sx:{height:80},divider:!0,children:[(0,B.jsx)(m.Z,{primary:(0,B.jsx)(s.Z,{variant:"subtitle1",children:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0441\u0435\u0440\u0432\u043e\u043f\u0440\u0438\u0432\u043e\u0434\u0430 \u043e\u0441\u044c X"})}),(0,B.jsx)(p.Z,{children:(0,B.jsx)(Z.Z,{sx:{bgcolor:C?Y.palette.success.main:Y.palette.error.main},children:C?(0,B.jsx)(b.Z,{}):(0,B.jsx)(y.Z,{})})})]}),(0,B.jsxs)(x.ZP,{sx:{height:80},divider:!0,children:[(0,B.jsx)(m.Z,{primary:(0,B.jsx)(s.Z,{variant:"subtitle1",children:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0441\u0435\u0440\u0432\u043e\u043f\u0440\u0438\u0432\u043e\u0434\u0430 \u043e\u0441\u044c Y"})}),(0,B.jsx)(p.Z,{children:(0,B.jsx)(Z.Z,{sx:{bgcolor:C?Y.palette.success.main:Y.palette.error.main},children:C?(0,B.jsx)(b.Z,{}):(0,B.jsx)(y.Z,{})})})]})]})})}),(0,B.jsx)(o.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,B.jsx)(k.Z,{id:"647ea168652edbe984336ebf"})}),(0,B.jsx)(o.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,B.jsx)(g.Z,{content:!1,children:(0,B.jsx)(T,{queryData:K,name:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"})})})]})}},80395:function(t,e,a){a.d(e,{_F:function(){return s},uQ:function(){return o}});var r=a(29439);function n(t){var e=Math.floor(t/3600);return[e,Math.floor(t/60)-60*e,Math.floor(t%60)]}function i(t,e){var a=[];return a[t]||(a[t]=t%100>4&&t%100<20?2:[2,0,1,1,1,2][Math.min(t%10,5)]),e[a[t]]}function o(t){var e=n(t),a=(0,r.Z)(e,3),o=a[0],s=a[1],d=a[2],c="";return o>0&&(c=o+" "+i(o,["\u0447\u0430\u0441","\u0447\u0430\u0441\u0430","\u0447\u0430\u0441\u043e\u0432"])),s>0&&(c+=" "+s+" "+i(s,["\u043c\u0438\u043d\u0443\u0442\u0430","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"])),d>0&&0===o&&(c+=" "+d+" "+i(d,["\u0441\u0435\u043a\u0443\u043d\u0434\u0430","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u0441\u0435\u043a\u0443\u043d\u0434"])),c}function s(t){var e,a,i=n(t),o=(0,r.Z)(i,3),s=o[0],d=o[1],c=o[2];return e=d,a=c,[s.toString().padStart(2,"0"),e.toString().padStart(2,"0"),a.toString().padStart(2,"0")].join(":")}}}]);
//# sourceMappingURL=71.eb00bc61.chunk.js.map